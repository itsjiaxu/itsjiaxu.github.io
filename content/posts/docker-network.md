---
title: Docker network
description: Docker network
publishedDate: 2025-08-29
tags:
  - documentation
  - docker
---

Docker 提供了几种内置的网络模式，每种都有其特定的用途。

### 1. `bridge` 模式

这是运行 `docker run` 命令时默认使用的网络模式。

工作原理：

当你运行容器时，Docker 会在宿主机上创建一个名为 docker0 的虚拟网桥。

1. 创建虚拟网桥：当 Docker 进程启动时，Docker 会在宿主机操作系统中创建一个名为 docker0 的虚拟网桥。
2. 创建虚拟网卡：为每个新容器创建一个虚拟以太网卡（Veth Pair）。这就像一根虚拟的 “网线”，一端在容器内部，另一端则连接到宿主机的虚拟网桥 docker0 上。
3. 桥接通信：
   - 容器内部：容器看到的是自己的虚拟网卡，它有一个独立的 IP 地址。
   - 容器之间：同一个 docker0 网桥上的所有容器，都可以通过虚拟网桥互相通信。网桥会根据容器的 MAC 地址进行转发。
   - 容器与外部网络：外部网络无法直接访问容器，需要通过端口映射（`-p`）将容器的端口暴露到宿主机上；当容器需要访问外部网络时，数据包会通过虚拟网桥 docker0，然后由宿主机进行地址转换（NAT），最后通过宿主机的物理网卡发送出去。

### 2. `host` 模式

工作原理: 这种模式下，容器直接使用宿主机的网络。容器不再有独立的 IP 地址，而是共享宿主机的 IP 地址和端口。

通信方式:

- 容器与宿主机: 容器可以访问宿主机的所有网络接口，并且可以像宿主机上的一个进程一样监听端口。
- 容器与外部网络：容器暴露的端口就是宿主机本身的端口，不需要进行端口映射。

### 3. `none` 模式

工作原理: 容器拥有独立的网络，但没有网络接口。它只能使用 `localhost` 回环地址，无法与外部或宿主机通信。

使用场景: 这种模式很少使用，通常用于需要高度隔离、不需要网络连接的特定任务，例如计算密集型任务。

### 4. `container` 模式

工作原理: 这种模式下，新创建的容器会共享另一个容器的网络栈。它们拥有相同的 IP 地址、端口等网络配置。两个容器的进程可以通过 lo 网卡设备通信。

使用场景: 这种模式通常用于边车模式，即一个主容器运行应用程序，另一个容器共享其网络，并提供一些辅助功能，比如日志收集、网络代理等。

### 5. 自定义 `bridge` 网络

除了默认的 `bridge` 网络，还可以创建自定义的 `bridge` 网络。

工作原理: 创建一个独立的网络，并让需要通信的容器加入这个网络。使用 `docker network create` 命令时，docker 会在宿主机上创建一个虚拟网桥，具有独立的 IP 地址段，并内置了 DNS 解析器。连接到同一个自定义网络的所有容器，都可以通过容器名来相互解析和通信。

优点:

- DNS 解析: 同一个自定义网络中的容器可以直接使用容器名互相通信，而不需要知道对方的 IP 地址。
- 隔离: 自定义网络为应用程序提供了一个私有的网络环境，默认情况下与其他网络中的容器隔离。
- 可移植性: 这种模式是 Docker Compose 等工具的核心，可以轻松地部署和管理多容器应用。
